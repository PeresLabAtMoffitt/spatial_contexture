---
title: "Investigate Univariate Spatial Contexture"
author: "Christelle Colin-Leitzinger"
date: '`r Sys.Date()`'
output: 
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: false
    theme: united
    highlight: pygments
    df_print: paged
editor_options: 
  chunk_output_type: console
---

<style type="text/css">
.figure {
   margin-top: 10px;
   margin-bottom: 25px;
}

table {
    margin-top: 10px;
    margin-bottom: 25px;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      cache = FALSE,
                      fig.align='center'
                      )
```

<style>
div.blue { background-color:#0099CC; border-radius: 5px; padding: 20px; font-size: 38px}
</style>
<div class = "blue">

<span style="color: white;">Univariate Ripley's K</span>

</div>
<br>

```{r library}
library(tidyverse)
library(ggplot2)
library(gtsummary)

theme_gtsummary_compact()
theme_set(theme_classic())
```

```{r}
markers_clinical <- read_rds("/Users/colinccm/Documents/GitHub/Peres/spatial_contexture/summarized_markers_clinical_ROI_04132023.rds")
markers_ROI <- markers_clinical %>% 
  drop_na(pair_id) %>% 
  group_by(pair_id) %>% 
  mutate(have_a_match = dense_rank(interaction(suid, pair_id))) %>% 
  group_by(pair_id) %>% 
  mutate(is_paired = max(have_a_match)) %>% 
  filter(is_paired == 2) %>% 
  select(pair_id, everything(), -c(is_paired, have_a_match)) %>% 
  ungroup()

bivariate_k <- read_rds("/Users/colinccm/Documents/GitHub/Peres/spatial_contexture/bivariate_k.rds")
```

# Data control - ICC?


# Study population - Patient characteristics

# Immune cell spatial's distribution
```{r}
bivariate_k %>% 
  tbl_summary
  
```











